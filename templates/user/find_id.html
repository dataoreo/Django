{% extends "base.html" %}
{% load static %}

{% block title %}아이디(이메일) 찾기 | DORO LMS{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/find_id.css' %}">
{% endblock %}

{% block content %}
<section class="hero">
  <div class="hero-inner">
    <h1 class="hero-title">아이디(이메일) 찾기</h1>
  </div>
</section>

<main class="card-wrap">
  <div class="card-inner">

    <section class="find-card" aria-labelledby="find-id-title">
      <div class="logo-row">
        <img src="{% static 'img/doro_logo.png' %}" alt="DORO 로고" class="brand-badge">
        <span class="logo-text"><b>DORO</b> | LMS</span>
      </div>

      <h2 id="find-id-title" class="card-title">가입 정보로 아이디 찾기</h2>
      <p class="card-desc">
        회원가입 시 입력하신 <strong>이름</strong>과 <strong>연락처(휴대폰)</strong>으로<br>
        DORO ID(이메일)를 찾아드립니다.
      </p>

      <form method="POST" action="{% url 'user:find_id' %}" class="find-form">
        {% csrf_token %}

        <div class="field">
          <label for="id_name">이름</label>
          <input
            type="text"
            id="id_name"
            name="name"
            placeholder="홍길동"
            required
          >
        </div>

        <div class="field">
          <label for="id_phone_number">연락처(휴대폰)</label>
          <input
            type="text"
            id="id_phone_number"
            name="phone_number"
            placeholder="010-1234-5678"
            required
          >
          <p class="help">숫자와 '-'를 포함해 정확히 입력해주세요.</p>
        </div>

        <button type="submit" class="btn-primary">아이디(이메일) 찾기</button>
      </form>

      {% if found_email %}
      <!-- ✅ 성공 결과 영역 -->
      <div class="result-box success" role="status">
        <p class="result-label">찾으신 DORO ID(이메일)는</p>
        <p class="result-email">{{ found_email }}</p>
        <p class="result-sub">보안상 일부만 마스킹된 이메일입니다.</p>

        <div class="result-actions">
          <a href="{% url 'user:login' %}" class="btn-primary">로그인 하러 가기</a>
          <a href="{% url 'index' %}" class="btn-secondary">홈으로</a>
        </div>
      </div>

      {% elif request.method == 'POST' %}
      <!-- ❌ 실패 결과 영역 (POST인데 found_email이 없는 경우) -->
      <div class="result-box error" role="alert">
        <p class="result-label">일치하는 계정을 찾을 수 없습니다.</p>
        <p class="result-sub">
          이름과 연락처를 다시 확인해주세요.<br>
          다른 이메일로 가입하셨을 수도 있습니다.
        </p>
        <div class="result-actions">
          <a href="{% url 'user:signup' %}" class="btn-secondary">회원가입 하러 가기</a>
        </div>
      </div>
      {% endif %}

      <div class="sub-links">
        <a href="{% url 'user:password_reset' %}">비밀번호가 기억나지 않나요?</a>
      </div>

    </section>

  </div>
</main>
{% endblock %}
