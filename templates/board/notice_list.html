{% extends "base.html" %}
{% load static %}

{% block title %}ê³µì§€ì‚¬í•­ | DORO LMS{% endblock %}

{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/notice_list.css' %}">
{% endblock %}

{% block content %}
<div id="canvas" class="notice-admin">

  {# ==== ë””ë²„ê·¸ ë°•ìŠ¤: ê¸°ì¡´ board/notice_list ê¸°ëŠ¥ ìœ ì§€ ==== #}
  <div class="debug-box">
    <h3>ğŸ” ë””ë²„ê¹… ì •ë³´</h3>
    <p><strong>ë¡œê·¸ì¸ ì—¬ë¶€:</strong> {{ request.user.is_authenticated }}</p>
    {% if request.user.is_authenticated %}
      <p><strong>ì‚¬ìš©ì ì´ë¦„:</strong> {{ request.user.name }}</p>
      <p><strong>ì‚¬ìš©ì ì´ë©”ì¼:</strong> {{ request.user.email }}</p>
      <p><strong>ì‚¬ìš©ì role:</strong> {{ request.user.role }}</p>
      <p><strong>ë²„íŠ¼ í‘œì‹œ ì¡°ê±´:</strong>
        {% if request.user.role == "instructor" or request.user.role == "manager" %}
          <span style="color: green; font-weight: bold;">âœ… ì¶©ì¡±</span>
        {% else %}
          <span style="color: red; font-weight: bold;">âŒ ë¶ˆì¶©ì¡± (role: {{ request.user.role }})</span>
        {% endif %}
      </p>
    {% else %}
      <p style="color: red;"><strong>ë¡œê·¸ì¸ë˜ì§€ ì•ŠìŒ</strong></p>
    {% endif %}
  </div>

  <!-- ğŸ¨ Hero ì˜ì—­ -->
  <section class="hero hero--notice">
    <div class="hero__inner">
      <h1 class="hero__title">ê³µì§€ì‚¬í•­</h1>
      <p class="hero__subtitle">
        ê´€ë¦¬ì ê³µì§€ ê´€ë¦¬ í™”ë©´ì…ë‹ˆë‹¤. ê³µì§€/ì ê²€ ìœ í˜•ê³¼ ëŒ€ìƒì„ í•„í„°ë§í•˜ê³  ë“±ë¡ëœ ê³µì§€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
    </div>
  </section>

  <!-- ğŸ“„ ê³µì§€ ë¦¬ìŠ¤íŠ¸ ì¹´ë“œ -->
  <main class="notice-layout" role="main" aria-label="ê³µì§€ì‚¬í•­ ëª©ë¡">
    <section class="card notice-card">

      <!-- íƒ­ í—¤ë” (ì „ì²´ / í•™ìƒ / ê°•ì‚¬) -->
      <header class="notice-card__header">
        <div class="notice-tabs" role="tablist" aria-label="ê³µì§€ ëŒ€ìƒ í•„í„°">
          <button type="button" class="notice-tab is-active">ì „ì²´</button>
          <button type="button" class="notice-tab">í•™ìƒ</button>
          <button type="button" class="notice-tab">ê°•ì‚¬</button>
        </div>
      </header>

      <!-- ê³µì§€ ë¦¬ìŠ¤íŠ¸ ë³¸ë¬¸ -->
      <div class="notice-card__body">
        <ul class="notice-list">
          {% for notice in notices %}
          <li class="notice-item">
            <div class="notice-item__badges">
              <!-- íƒ€ì… ë±ƒì§€ -->
              <span class="badge badge--type-alert">
                {% if notice.is_pinned %}ê³µì§€{% else %}ê³µì§€{% endif %}
              </span>

              <!-- ëŒ€ìƒ ë±ƒì§€ -->
              {% if notice.target %}
                {% if notice.target == "STUDENT" %}
                  <span class="badge badge--role-student">í•™ìƒ</span>
                {% elif notice.target == "TEACHER" %}
                  <span class="badge badge--role-teacher">ê°•ì‚¬</span>
                {% else %}
                  <span class="badge badge--role-all">ì „ì²´</span>
                {% endif %}
              {% else %}
                <span class="badge badge--role-all">ì „ì²´</span>
              {% endif %}
            </div>

            <a href="{% url 'board:notice_detail' notice.notice_id %}"
               class="notice-item__title">
              {{ notice.title }}
              <span class="notice-item__date">
                ({{ notice.created_at|date:"Y-m-d" }})
              </span>
            </a>
          </li>
          {% empty %}
          <li class="notice-item">
            <span style="color:#6B7280;">ë“±ë¡ëœ ê³µì§€ì‚¬í•­ì´ ì—†ìŠµë‹ˆë‹¤.</span>
          </li>
          {% endfor %}
        </ul>
      </div>

      <!-- í˜ì´ì§€ë„¤ì´ì…˜ + ê³µì§€ ë“±ë¡ ë²„íŠ¼ -->
      <footer class="notice-card__footer">
        <div class="notice-admin__pagination">
          {% if is_paginated %}
            <button type="button" class="page-arrow" {% if not page_obj.has_previous %}disabled{% endif %}>
              â—€
            </button>
            <span class="page-info">
              {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}
            </span>
            <button type="button" class="page-arrow" {% if not page_obj.has_next %}disabled{% endif %}>
              â–¶
            </button>
          {% else %}
            <span class="page-info">1 / 1</span>
          {% endif %}
        </div>

        <div class="notice-admin__actions">
          {# ê´„í˜¸ ëŒ€ì‹  ì¤‘ì²© ifë¡œ ë¶„ë¦¬ #}
          {% if request.user.is_authenticated %}
            {% if request.user.role == "instructor" or request.user.role == "manager" %}
              <a href="{% url 'board:notice_create' %}"
                 class="btn-primary notice-admin__btn-create">
                ê³µì§€ ë“±ë¡
              </a>
            {% endif %}
          {% endif %}
        </div>
      </footer>

    </section>
  </main>

  <!-- ğŸ“Œ ìš°ì¸¡ ê³ ì • ë°°ë„ˆ -->
  <aside class="support-banner" aria-label="ê³ ê°ì§€ì› ë°”ë¡œê°€ê¸°">
    <button type="button" class="support-banner__item">
      <span class="support-banner__icon support-banner__icon--chat"></span>
      <span class="support-banner__label">ì±—ë´‡<br>ë°”ë¡œê°€ê¸°</span>
    </button>
    <button type="button" class="support-banner__item">
      <span class="support-banner__icon support-banner__icon--phone"></span>
      <span class="support-banner__label">ìƒë‹´ ì „í™”<br>ë°”ë¡œê°€ê¸°</span>
    </button>
    <button type="button" class="support-banner__item">
      <span class="support-banner__icon support-banner__icon--qna"></span>
      <span class="support-banner__label">1:1 ë¬¸ì˜<br>ë°”ë¡œê°€ê¸°</span>
    </button>
  </aside>

</div>
{% endblock %}

